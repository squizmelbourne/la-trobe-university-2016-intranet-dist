"use strict";var navUserHandler={settings:{el:"",dataURL:"",builderURL:"",mobiletoggle:!1,promise:""},init:function(e,n){navUserHandler.settings.el=e,navUserHandler.settings.dataURL=e.getAttribute("data-userdata-url"),navUserHandler.settings.builderURL=e.getAttribute("data-builder-url"),navUserHandler.settings.promise=n,navUserHandler.toggleLoadingState(e),navUserHandler.localStorageExists()?navUserHandler.getMarkup(localStorage.getItem("user")):$.get(navUserHandler.settings.dataURL,function(e){localStorage.setItem("user",e),navUserHandler.getMarkup(e)})},toggleLoadingState:function(e){var n=e.classList;n.contains("nav-user--condensed")?n.toggle("nav-user--condensed-loading"):n.contains("nav-user")&&n.toggle("nav-user--loading")},localStorageExists:function(){return localStorage.getItem("user")},getQueryDataObjArr:function(e){var n=!!navUserHandler.settings.el.classList.contains("nav-user--condensed"),t=!(e.businessTools.length||e.tasks.length||e.favourites.length),a=!!navUserHandler.settings.el.classList.contains("js-nav-user--mobile-toggle");return navUserHandler.settings.mobiletoggle=a,a?[{userdata:e,notoolsflag:t,condensedflag:!1,mobiletoggle:a}]:!a&&n?[{userdata:e,notoolsflag:t,condensedflag:!n,mobiletoggle:!1},{userdata:e,notoolsflag:t,condensedflag:n,mobiletoggle:!1}]:[{userdata:e,notoolsflag:t,condensedflag:!1,mobiletoggle:!1}]},getMarkup:function(e){var n=navUserHandler.getQueryDataObjArr(JSON.parse(e));Promise.all(n.map(function(e){return new Promise(function(n,t){$.ajax({url:navUserHandler.settings.builderURL,type:"get",data:e,success:function(e){n(e)}})})})).then(function(e){navUserHandler.print(e)})},print:function(e){var n=document.getElementById("nav-user-slide").querySelector(".nav-user");e.length>1?(n.innerHTML=n.innerHTML+e[0],navUserHandler.settings.el.innerHTML=e[1]):navUserHandler.settings.mobiletoggle?navUserHandler.settings.el.innerHTML=e[0]:(n.innerHTML=n.innerHTML+e[0],navUserHandler.settings.el.innerHTML=e[0]),navUserHandler.toggleLoadingState(navUserHandler.settings.el),navUserHandler.settings.promise&&navUserHandler.settings.promise.resolve(null)}};!function(){var e=new jQuery.Deferred(function(e){navUserHandler.init(document.querySelector(".js-nav-user"),e)});e.then(function(){navUserHandler.init(document.querySelector(".js-nav-user--mobile-toggle")),document.querySelector("body").classList.add("nav-user-loaded")})}(jQuery);