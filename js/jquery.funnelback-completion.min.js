"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function($){function replaceQueryInQuestionWithPartialQuery(e,t,o){var n=htmlDecode(e),a=t.split(" "),l=a[a.length-1],i=t.substring(0,t.length-l.length);0==i.length&&(i="!padrenull");for(var r=n.split("&"),c="",s=!1,u=!1,g=0;g<r.length;g++)"query="==r[g].substring(0,6)?(c+="query="+i,s=!0):null!=o&&"profile="==r[g].substring(0,8)?(c+="profile="+o,u=!0):c+=r[g],c+="&";return s||(c+="query="+i,c+="&"),u||null==o||(c+="profile="+o,c+="&"),c.substring(0,c.length-1)}function htmlDecode(e){return $("<div/>").html(e).text()}$.fn.fbcompletion=function(settings){var facetBasedCompletionSuccess=function(e,t,o){var n=new Array,a=t.term.split(" "),l=a[a.length-1],i=t.term.substring(0,t.term.length-l.length);"|"==l.substring(0,1)&&(l=l.substring(l.indexOf(":")+1,l.length));for(var r=l.toLowerCase(),c=o.response.facets,s=1,u=0;u<c.length;u++){var g=c[u],m=g.name;if("undefined"!=typeof g.categories)for(var p=g.name.substring(0,l.length).toLowerCase()==r,f=0;f<g.categories[0].values.length;f++){var d=g.categories[0].values[f],y="|"+d.constraint+":"+d.label;if((d.label.substring(0,l.length)==l||p)&&t.term.indexOf(y)==-1){var b={action_t:"E",action:i+y+" ",value:i+d.label,category:m,rank:s,matchOn:t.term,disp_t:"H",disp:d.label,wt:500};n.push({label:b.disp,value:b.value,extra:b,matchOn:b.matchOn,category:b.category,rank:b.rank}),s++}}}return n},config={collection:"funnelback_documentation",show:10,sort:0,delay:0,length:3,alpha:.5,program:"/s/redirect",interactionLog:"/s/log",format:"simple",enabled:"disabled",standardCompletionEnabled:!0,logging:"enabled",dwellLogging:"enabled",dwellLoggingTimeout:3e3,selectLogging:"enabled",tmplId:"fb-completion-tmpl",profile:"_default",searchBasedCompletionEnabled:!1,searchBasedCompletionProgram:"/s/redirect",searchBasedCompletionProfile:null,searchBasedCompletionFunction:facetBasedCompletionSuccess,zindex:1e3},logger=function(e,t,o,n,a){if(e&&"enabled"===config.logging){var l=config.interactionLog+"?collection="+config.collection+"&type="+encodeURIComponent(o)+"&client_time="+(new Date).getTime()+(""!==config.profile?"&profile="+config.profile:"");for(var i in n)l+="&"+encodeURIComponent(i)+"="+encodeURIComponent(n[i]);t?(a(),jQuery.ajax({type:"GET",url:l,error:function(e,t,o){window.console&&console.log("Interaction log error: "+t+", "+o)}})):jQuery.ajax({type:"GET",url:l,error:function(e,t,o){window.console&&console.log("Interaction log error: "+t+", "+o),a()},success:function(e){a()}})}else a()};if(settings&&$.extend(config,settings),"enabled"==config.enabled)return this.each(function(){var targetElement=this,dwellTimeoutCallback,compiledTmpl;jQuery().template&&(compiledTmpl=jQuery("#"+config.tmplId).length>0?jQuery("#"+config.tmplId).template():jQuery("<script>[Error: Template <tt>"+config.tmplId+"</tt> not found]</script>").template()),$(targetElement).autocomplete({appendTo:$("#fb-queryform").length>0?"#fb-queryform":"body",source:function(e,t){var o=[!config.searchBasedCompletionEnabled,!config.standardCompletionEnabled],n=[new Array,new Array];config.searchBasedCompletionEnabled&&jQuery.ajax({type:"GET",url:config.searchBasedCompletionProgram+"?"+replaceQueryInQuestionWithPartialQuery(config.query,e.term,config.searchBasedCompletionProfile),dataType:"jsonp",error:function(e,t,o){window.console&&console.log("Autocomplete error: "+t+", "+o)},success:function(a){n[0]=config.searchBasedCompletionFunction(config,e,a),o[0]=!0,o[1]&&t(n[1].concat(n[0]))}}),config.standardCompletionEnabled&&jQuery.ajax({type:"GET",url:config.program+"?collection="+config.collection+"&partial_query="+e.term.replace(/ /g,"+")+"&show="+config.show+"&sort="+config.sort+"&alpha="+config.alpha+"&fmt="+("simple"==config.format?"json":"json++")+(""!==config.profile?"&profile="+config.profile:""),dataType:"jsonp",error:function(e,t,o){window.console&&console.log("Autocomplete error: "+t+", "+o)},success:function(a){for(var l=n[1],i=0;i<a.length;i++){var r=a[i];null!=r&&("string"==typeof r?l.push({label:r,matchOn:e.term,rank:i+1}):"object"==("undefined"==typeof r?"undefined":_typeof(r))&&l.push({label:r.disp?r.disp:r.key,value:"Q"==r.action_t?r.action:r.key,extra:r,matchOn:e.term,category:r.cat,rank:i+1}))}o[1]=!0,o[0]&&t(n[1].concat(n[0]))}})},open:function(){return jQuery(this).autocomplete("widget").css("z-index",config.zindex),"undefined"!=typeof dwellTimeoutCallback&&clearTimeout(dwellTimeoutCallback),"enabled"===config.dwellLogging&&(dwellTimeoutCallback=setTimeout(function(e){var t=$(targetElement).val();logger("enabled"===config.dwellLogging,!0,"dwell",{partial_query:t},function(){})},config.dwellLoggingTimeout)),!1},close:function(){"undefined"!=typeof dwellTimeoutCallback&&clearTimeout(dwellTimeoutCallback)},delay:config.delay,minLength:config.length,select:function select(evt,ui){var logMayBeAsync=!1;return ui.item.extra&&("C"!=ui.item.extra.action_t&&"E"!=ui.item.extra.action_t||(logMayBeAsync=!0)),logger("enabled"===config.selectLogging,logMayBeAsync,"select",{action_type:ui.item.extra.action_t,action:ui.item.extra.action,value:ui.item.value,category:ui.item.category,rank:ui.item.rank,partial_query:ui.item.matchOn},function(){if(ui.item.extra)switch(ui.item.extra.action_t){case"C":eval(ui.item.extra.action);break;case"U":document.location=ui.item.extra.action;break;case void 0:case"":$(targetElement).val(ui.item.value),$(targetElement).closest("form").submit();break;case"E":$(targetElement).val(ui.item.extra.action);var that=$(targetElement);setTimeout(function(){that.autocomplete("search")},1);break;case"Q":default:$(targetElement).val(ui.item.extra.action),$(targetElement).closest("form").submit()}else $(targetElement).val(ui.item.value),$(targetElement).closest("form").submit()}),!1}}).data("ui-autocomplete")._renderItem=function(ul,item){var label;if(item.extra)switch(item.extra.disp_t){case"J":label=compiledTmpl?jQuery.tmpl(compiledTmpl,item.extra.disp).appendTo("<p></p>").parent().html():"[Error: jQuery template plugin is unavailable]";break;case"C":label=eval(item.extra.disp);break;case"T":label=item.label.replace(new RegExp("("+item.matchOn+")","i"),"<strong>$1</strong>");break;case"H":default:label=item.label}else label=item.label.replace(new RegExp("("+item.matchOn+")","i"),"<strong>$1</strong>");return jQuery("<li></li>").data("item.autocomplete",item).append("<a>"+label+"</a>").appendTo(ul)},$(targetElement).data("ui-autocomplete")._renderMenu=function(e,t){var o=this,n="";jQuery.each(t,function(t,a){a.category&&a.category!=n&&(e.append('<li class="ui-autocomplete-category">'+a.category+"</li>"),n=a.category),o._renderItemData(e,a)})}}),this},jQuery("[data-toggle=tooltip]").tooltip({html:!0}),jQuery("#quick-search__query").fbcompletion({enabled:"enabled",collection:"intranet-2016-meta",program:"https://search.latrobe.edu.au/s/suggest.json",format:"extended",alpha:".5",show:"10",sort:"0",length:"3",delay:"0",profile:"_default_preview",logging:"disabled"})}(jQuery);